import{a as M,b as a,c as E,d as N,e as O,f as p,g as T,h as F,i as $,j as q,k as A}from"./chunk-MYAEOQXR.js";import{a as v}from"./chunk-QWVBYHIC.js";import{a as y}from"./chunk-TVGKWIY7.js";import"./chunk-N65F7NND.js";import"./chunk-E4YH2Q2X.js";import{Ca as V,Q as x,Ra as _,Sa as h,V as l,W as u,Xa as w,Ya as i,Za as o,db as P,ea as S,fb as m,hb as g,ob as c,qb as C,ua as d}from"./chunk-KQCILP4R.js";var b=n=>{let t=n.value;if(!t)return null;let e={};return t.length<6&&(e.minlength={requiredLength:6,actualLength:t.length}),/[A-Z]/.test(t)||(e.uppercase=!0),/[a-z]/.test(t)||(e.lowercase=!0),/\d/.test(t)||(e.number=!0),/[!@#$%^&*(),.?":{}|<>]/.test(t)||(e.specialChar=!0),Object.keys(e).length>0?e:null};function j(n,t){if(n&1){let e=P();i(0,"input",12),m("input",function(){l(e);let s=g();return u(s.clearError())}),o()}}function k(n,t){if(n&1&&c(0),n&2){let e=g().validationErrors[0];C(" ",e," ")}}function D(n,t){if(n&1&&c(0),n&2){let e=g();C(" ",e.errorMessage()," ")}}var L=class n{userService=x(y);form;errorMessage=S(null);constructor(){this.form=new O({name:new p("",{validators:[a.maxLength(24)]}),email:new p("",{validators:[a.email,a.maxLength(24)]}),login:new p("",{nonNullable:!0,validators:[a.required,a.maxLength(24)]}),password:new p("",{validators:[a.maxLength(24),b]}),newPassword:new p("",{validators:[a.maxLength(24),b]})})}get validationErrors(){let t=[];for(let[e,r]of Object.entries(this.form.controls))r.errors&&r.touched&&(r.errors.required&&t.push(`${e} is required`),r.errors.maxlength&&t.push(`${e} is too long`),r.errors.email&&t.push(`${e} is wrong`),r.errors.minlength&&t.push(`${e} must be at least 6 characters`),r.errors.uppercase&&t.push(`${e} must contain at least one uppercase letter`),r.errors.lowercase&&t.push(`${e} must contain at least one lowercase letter`),r.errors.number&&t.push(`${e} must contain at least one number`),r.errors.specialChar&&t.push(`${e} must contain at least one special character`));return t}ngOnInit(){let t=this.userService.user();this.form.patchValue(t||{})}clearError(){this.errorMessage.set(null)}isNonAnonymousUser(){return!!this.userService.user()?.login}onSubmit(){let t=this.userService.user();if(!t)return;let e=this.form.getRawValue();this.userService.requestUpdate(t?.id,e).subscribe({error:r=>{r.status===401?this.errorMessage.set(v.unauthorized):this.errorMessage.set(v.unexpected)},next:()=>{}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-profile"]],decls:17,vars:4,consts:[[1,"login"],[1,"login__form",3,"ngSubmit","formGroup"],[1,"login__form_header"],["formControlName","name","placeholder","name",3,"input"],["formControlName","email","placeholder","email",3,"input"],["formControlName","login","placeholder","login*","required","",3,"input"],["formControlName","password","type","password","placeholder","password*"],["formControlName","newPassword","type","password","placeholder","new password",3,"input"],[1,"login__form_error"],[1,"login__form_btns"],["type","submit",1,"button",3,"disabled"],["type","reset",1,"button"],["formControlName","password","type","password","placeholder","password*",3,"input"]],template:function(e,r){if(e&1){let s=P();i(0,"div",0)(1,"form",1),m("ngSubmit",function(){return l(s),u(r.onSubmit())}),i(2,"h3",2),c(3,"Profile"),o(),i(4,"input",3),m("input",function(){return l(s),u(r.clearError())}),o(),i(5,"input",4),m("input",function(){return l(s),u(r.clearError())}),o(),i(6,"input",5),m("input",function(){return l(s),u(r.clearError())}),o(),_(7,j,1,0,"input",6),i(8,"input",7),m("input",function(){return l(s),u(r.clearError())}),o(),i(9,"div",8),_(10,k,1,1)(11,D,1,1),o(),i(12,"div",9)(13,"button",10),c(14,"Save"),o(),i(15,"button",11),c(16,"Reset"),o()()()()}if(e&2){let s=r.isNonAnonymousUser();d(),w("formGroup",r.form),d(6),h(s?7:-1),d(3),h(r.validationErrors.length?10:11),d(3),w("disabled",r.form.invalid)}},dependencies:[A,T,M,E,N,q,F,$],styles:["[_nghost-%COMP%]{width:100%;height:calc(100dvh - 6rem);display:flex;justify-content:center;align-items:center}.login[_ngcontent-%COMP%]{width:16rem;background-color:var(--color10);border-radius:.5rem;border:var(--border-thickness) solid var(--color30)}.login__form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;row-gap:1rem;padding:1rem 2rem}.login__form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .login__form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem}.login__form_header[_ngcontent-%COMP%]{text-align:center;margin-top:0}.login__form_btns[_ngcontent-%COMP%]{display:flex;justify-content:center;column-gap:1rem}.login__form_error[_ngcontent-%COMP%]{font-size:smaller;color:red}"]})};export{L as PageProfile};
